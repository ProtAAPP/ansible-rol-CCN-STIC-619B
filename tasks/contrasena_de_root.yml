---
- name: Configurar la caducidad de la clave de root
  become: true
  ansible.builtin.shell: |
    grep "root:[^:]*:[0-9]*:2:45:10:" /etc/shadow > /dev/null 2>%1
    if [ $? -eq 1 ]
    then
      /usr/bin/chage -m 2 -M {{ PASS_MAX_DAYS }} -W 10 root
      echo $?
    fi
  register: root_pass_change_params
  changed_when: root_pass_change_params.stdout == "0"
  notify: Forzar_cambio_de_password_de_root
